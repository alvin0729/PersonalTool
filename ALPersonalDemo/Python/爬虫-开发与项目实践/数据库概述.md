##数据库概述##

  数据库是存储数据的仓库即数据的集散地，App如果有大量的数据需要进行本地存储就可以考虑使用数据库技术，它不仅能够有效的存储和管理数据，更重要的是提供了方便的检索数据的手段。简单的说，数据库是实现数据持久化的重要方案，其他的方案包括：plist文件、archieve归档、NSUserDefaults、普通文件等。
  目前广泛使用的数据库采用了关系模型，也称之为关系型数据库，关系型数据库的理论基础是关系代数，在实现上通过二维表来组织数据。

###常见关系型数据库产品###

- Oracle：甲骨文公司的大型关系数据库系统，功能完善安全性好，支持商业智能
- DB2：IBM公司的产品，数据仓库和数据挖掘功能非常强大
- SQLServer：微软的产品，适合微软自己的Windows服务器环境
- MySQL：开源的数据库产品，中小型站点的数据库服务器首选


###相关概念###

- 表：关系型数据库通过二维表组织数据
- 行：表格中的一行代表一条记录
- 列：表格中的一列是一个字段（属性）
- 主键：唯一标识一条记录
- 外键：其他表的主键，实现参照完整性
- 数据完整性：实体完整性、域完整性和参照完整性

##SQLite入门##

  [官方网站](http://www.sqlite.org)

  SQLite是几乎所有移动操作系统的标准数据库(事实标准)，属于嵌入式数据库系统。

  启动SQLite：在终端键入sqlite3，提示符变成sqlite>

  常用命令：

	.help --- 显示帮助信息
	.quit/.exit --- 退出
	.open --- 打开指定的数据库文件
	.save --- 将内存中的数据库保存到指定的文件
	.databases --- 显示数据库的信息
	.schema ?TABLE? --- 显示表结构
	.tables ?PATTERN? --- 显示所有的表
	.mode MODE --- 设置输出模式
	.stats ON|OFF --- 开启或关闭统计信息
	.dump ?TABLE?--- 以SQL文本格式转存数据库

##SQL简介##

  SQL全称结构化查询语言，是数据库的编程语言，可以分为DDL（数据定义语言）、DML（数据操纵语言）、DQL（数据查询语言）和DCL（数据控制语言）。

- DDL: create、drop、alter
- DML: insert、delete、update
- DQL: select
- DCL: grant、revoke

  例子：创建一张部门表和一张员工表，完成下面的查询。

```SQL
create table TbDept
(
deptno tinyint primary key,
dname varchar(10) not null,
dloc varchar(20) not null
);

insert into TbDept values (10, '会计部', '北京');
insert into TbDept values (20, '研发部', '成都');
insert into TbDept values (30, '销售部', '重庆');
insert into TbDept values (40, '运维部', '深圳');

create table TbEmp
(
empno int primary key,
ename varchar(20) not null,
job varchar(10) not null,
mgr int,
sal int not null,
dno tinyint,
foreign key (dno) references TbDept(deptno)
);

insert into TbEmp values (7800, '张三丰', '总裁', null, 9000, 20);
insert into TbEmp values (2056, '乔峰', '分析师', 7800, 5000, 20);
insert into TbEmp values (3088, '李莫愁', '设计师', 2056, 3500, 20);
insert into TbEmp values (3211, '张无忌', '程序员', 2056, 3200, 20);
insert into TbEmp values (3233, '丘处机', '程序员', 2056, 3400, 20);
insert into TbEmp values (3251, '张翠山', '程序员', 2056, 4000, 20);
insert into TbEmp values (5566, '宋远桥', '会计师', 7800, 4000, 10);
insert into TbEmp values (5234, '郭靖', '出纳', 5566, 2000, 10);
insert into TbEmp values (3344, '黄蓉', '销售主管', 7800, 3000, 30);
insert into TbEmp values (1359, '胡一刀', '销售员', 3344, 1800, 30);
insert into TbEmp values (4466, '苗人凤', '销售员', 3344, 2500, 30);
insert into TbEmp values (3244, '欧阳锋', '程序员', 3088, 3200, 20);
insert into TbEmp values (3577, '杨过', '会计', 5566, 2200, 10);
insert into TbEmp values (3588, '朱九真', '会计', 5566, 2500, 10);
```

  SQL练习：

0. 查询最高工资及其对应员工

   ```SQL
   select ename, sal from TbEmp where sal=(select max(sal) from TbEmp);
   ```

1. 计算每位员工的年薪

  ```SQL
  select ename, sal*12 as annSal from TbEmp;
  ```

2. 统计有员工的部门的人数

  ```SQL
  select dno, count(dno) from TbEmp group by dno;
  ```

3. 求挣最高薪水的员工(boss除外)的姓名

  ```SQL
  select ename, sal from TbEmp where sal=(select max(sal) from TbEmp where mgr is not null);
  ```

4. 查询薪水超过平均薪水的员工的姓名和工资

    ```SQL
    select ename,sal from tbemp where sal >(select avg(sal) from tbemp);
    ```

5. 查询薪水超过其所在部门平均薪水的员工的姓名、部门编号和工资

  ```SQL
  select ename, sal, t1.dno from TbEmp as t1,
  (select dno, avg(sal) as avgSal from TbEmp group by dno) as t2 where 	t1.dno=t2.dno and t1.sal>t2.avgSal;

  select ename, sal, t1.dno from TbEmp as t1 inner join
  (select dno, avg(sal) as avgSal from TbEmp group by dno) as t2 on 
  t1.dno=t2.dno and t1.sal>t2.avgSal;
    
    select ename,t1.dno,sal from tbemp as t1 inner join (select dno,avg(sal) as avgSal from tbemp group by dno) as t2 on t1.dno = t2.dno and sal >avgSal;
  ```

6. 查询部门中薪水最高的人姓名、工资和所在部门名称
     ```SQL
     select ename ,sal ,dname from (select ename,sal ,t1.dno from tbemp as t1 inner join(select dno ,max(sal) as maxSal from tbemp group by dno) as t2 on t1.dno = t2.dno and sal = maxSal) as t3 inner join tbdept as t4 where dno = deptno;
     ```

7. 哪些人是主管

  ```SQL
  select ename, job from TbEmp where empno in (select distinct mgr from TbEmp where mgr is not null);
    select ename from tbemp where empno in(select distinct mgr from tbemp where mgr is not null)；
  ```
    >intersect 交集
    >  union并集
    >  inus差集
    >  in
    >  去重和集合运算
8. 求平均薪水最高的部门的名称和平均工资

    ```SQL
     select dname,maxSal from (select dno,max(avgSal) as maxSal from(select dno,avg(sal) as avgSal from tbemp group by dno)) as t1 inner join tbdept as t2 on t1.dno = t2.deptno;
    ```

9. 求薪水最高的前3名雇员

  ```SQL
  select ename, sal from TbEmp order by sal desc limit 3;
  ```

10. 求薪水排在第4-6名雇员

  ```SQL
  select ename, sal from TbEmp order by sal desc limit 3 offset 3;
    select * FROM tbemp order by sal desc limit 3,3;
  ```

11. 求薪水最低的部门经理所在部门的名称
    ```SQL
    select dname,ename,minSal from (select dno,ename,min(sal) as minSal from tbemp where empno in(select DISTINCT mgr from tbemp where mgr is not null)) as t1 inner join tbdept as t2 on t1.dno = t2.deptno;
    ```

##FMDB的使用##

  [FMDB下载地址](https://github.com/ccgus/fmdb)

  官方提供的对SQLite的操作都是比较底层的C函数，用起来相对比较麻烦。FMDB对这些底层的东西进行了面向对象的封装，是一个非常好用的第三方库，使用时需要添加苹果提供的依赖库libsqlite3.dylib。

  FMDB的核心API：
​	
	FMDatabase --- 代表数据库
	FMResultSet --- 代表操作查询结果的游标
	FMDatabaseAdditions --- 对FMDatabase类扩展的Category
	FMDatabasePool --- 数据库连接池支持类
	FMDatabaseQueue --- 数据库多线程操作支持类

```Objective-C
// 创建数据库
- (void) createDb {
    NSString *path = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/test.db"];
    NSLog(@"%@", path);
    self.db = [[FMDatabase alloc] initWithPath:path];
    if([self.db open]) {
        [self createTable];
    }
    else {
        NSLog(@"创建数据库失败!");
    }
}

// 创建表
- (void) createTable {
    NSString *sql = @"create table if not exists tb_user (username varchar(20) primary key, password varchar(20) not null, email varchar(50));";
    if([self.db executeUpdate:sql]) {
        [self insertData];
    }
    else {
        NSLog(@"创建用户表失败!");
    }
}

// 插入数据
- (void) insertData {
    NSString *sql = @"insert into tb_user values (?,?,?);";
    if([self.db executeUpdate:sql, @"jackfrued", @"123456", @"jackfrued@126.com"]) {
        
    }
    else {
        NSLog(@"插入数据失败!");
    }
}

// 显示表中的记录
- (void) showRecords {
    NSString *path = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/test.db"];
    self.db = [[FMDatabase alloc] initWithPath:path];
    if([self.db open]) {
        NSString *sql = @"select * from tb_user";
        FMResultSet *rs = [self.db executeQuery:sql];
        NSLog(@"%d", rs.next);
        while([rs next]) {
            NSLog(@"Username: %@", [rs stringForColumn:@"username"]);
            NSLog(@"Password: %@", [rs stringForColumn:@"password"]);
            NSLog(@"Email: %@", [rs stringForColumn:@"email"]);
        }
        
        [self clearData];
    }
    else {
        NSLog(@"创建数据库失败!");
    }
}

- (void) clearData {
    NSString *sql = @"delete from tb_user";
    if([self.db executeUpdate:sql]) {
        NSLog(@"清理数据成功!!!");
    }
}
```
--------------------------------------------------
##💃🏻数据库
 - 数据库: 数据的集散地，有效的存储和管理数据
 - 关系型数据库：1. 用二维表组织数据; 2. 结构化查询语言(SQL - Structured Query Language)

```
行：一条记录
列：一个字段
主键：能够唯一标识一条记录的字段
外键：其他表的主键(外来的主键)
Oracle
DB2
SQLServer
MySQL
```
######学生表

```
学号	姓名	性别 出生日期 家庭住址
1001	骆昊	男	1980-11-28 四川成都
1002 王大锤 女	1990-1-1 四川自贡
SQL
	DDL - 数据定义语言 create / drop / alter
	DML - 数据操作语言 insert / delete / update
	DQL - 数据查询语言 select
	DCL - 数据控制语言 grant / revoke
```
######集合论

```
关系代数
数据库设计 - ER图(实体关系图)
一对一 ---> 人和身份证
一对多 --->  部门和员工、用户和订单
多对多 ---> 订单和商品、读者和图书```

```
--删除表
drop table TbStudent;

--创建表
create table TbStudent
(
stuid integer primary key, --学号
stuname varchar(20) not null, -- 姓名
stusex char(1) default '男', --性别
stuaddr varchar(50) --家庭住址
);

--修改表
alter table TbStudent add stubirth date;

--插入记录
insert into TbStudent values (1001, '骆昊', '男', '四川成都', '1980-11-28');
insert into TbStudent (stuid, stuname) values (1002, '王大锤');
insert into TbStudent (stuid, stuname) values (1003, '王大锤');
insert into TbStudent (stuid, stuname, stusex, stubirth) values (1004, '李莫愁', '女', '1986-12-3');
insert into TbStudent values (1005, '张三丰', '男', '四川成都', '1975-5-5');
insert into TbStudent values (1006, '李二王', '女', '四川绵阳', '1988-6-6');
insert into TbStudent values (1007, '王丽', '女', '四川成都', '1992-2-2');

--删除数据
delete from TbStudent where stuid=1003;
delete from TbStudent where stuname='王大锤';

--更新数据
update TbStudent set stuaddr='四川绵阳', stubirth='1990-4-5' where stuid=1002;
update TbStudent set stuaddr='湖南长沙' where stuid=1004;

--查询所有行所有列
select * from TbStudent;

--投影操作
select stuname, stusex from TbStudent;
--在投影时别名
select stuname as 姓名, stusex as 性别 from TbStudent;

--数据筛选
select * from TbStudent where stusex='男';
select * from TbStudent where stusex='男' and stuaddr='四川成都';
select * from TbStudent where stusex='男' or stuaddr='四川成都';
select * from TbStudent where stubirth between '1985-1-1' and '1989-12-31';
select * from TbStudent where stubirth<'1980-1-1';
select * from TbStudent where stuname like '王%';
select * from TbStudent where stuname like '王_';
select * from TbStudent where stuname like '王__';
select * from TbStudent where stuname like '%王%';

--排序
select * from TbStudent order by stubirth asc;
select * from TbStudent order by stubirth desc;
select * from TbStudent order by stusex, stuid desc; 

--分组
select stusex, count(stusex) from TbStudent group by stusex;
select stuaddr, count(stuaddr) from TbStudent group by stuaddr;
select stuaddr 家庭住址, count(stuaddr) as 总人数 from TbStudent group by stuaddr order by 总人数;
select count(stuid) from TbStudent;

--聚合函数/分组函数
count
max
min
avg
sum

select min(stubirth) from TbStudent;

--子查询(把一个查询的结果作为另一个查询的一部分来使用)
select stuname, stubirth from TbStudent where stubirth=(select min(stubirth) from TbStudent);
select stuname, stubirth from TbStudent where stubirth=(select max(stubirth) from TbStudent);

--连接查询
	---> 内连接
	---> 外连接  ---> 左外连接
							---> 右外连接
							---> 全外连接
pragma foreign_key=on;


-- 一对一外键关联
create table TbPerson
(
pid integer primary key,
pname varchar(20) not null,
ptel char(11) not null,
paddr varchar(50)
);

create table TbIdCard
(
cid char(18) primary key,
corg varchar(50) not null,
cvaldate date not null,
pid integer unique references TbPerson(pid)
);

--一对多外键关联
create table TbDept
(
deptno tinyint primary key,
dname varchar(10) not null,
dloc varchar(20) not null
);

insert into TbDept values (10, '会计部', '北京');
insert into TbDept values (20, '研发部', '成都');
insert into TbDept values (30, '销售部', '重庆');
insert into TbDept values (40, '运维部', '深圳');

create table TbEmp
(
empno int primary key,
ename varchar(20) not null,
job varchar(10) not null,
mgr int,
sal int not null,
dno tinyint,
foreign key (dno) references TbDept(deptno)
);

insert into TbEmp values (7800, '张三丰', '总裁', null, 9000, 20);
insert into TbEmp values (2056, '乔峰', '分析师', 7800, 5000, 20);
insert into TbEmp values (3088, '李莫愁', '设计师', 2056, 3500, 20);
insert into TbEmp values (3211, '张无忌', '程序员', 2056, 3200, 20);
insert into TbEmp values (3233, '丘处机', '程序员', 2056, 3400, 20);
insert into TbEmp values (3251, '张翠山', '程序员', 2056, 4000, 20);
insert into TbEmp values (5566, '宋远桥', '会计师', 7800, 4000, 10);
insert into TbEmp values (5234, '郭靖', '出纳', 5566, 2000, 10);
insert into TbEmp values (3344, '黄蓉', '销售主管', 7800, 3000, 30);
insert into TbEmp values (1359, '胡一刀', '销售员', 3344, 1800, 30);
insert into TbEmp values (4466, '苗人凤', '销售员', 3344, 2500, 30);
insert into TbEmp values (3244, '欧阳锋', '程序员', 3088, 3200, 20);
insert into TbEmp values (3577, '杨过', '会计', 5566, 2200, 10);
insert into TbEmp values (3588, '朱九真', '会计', 5566, 2500, 10);

1.select  ename,sal from TbEmp where sal=(select max(sal) from TbEmp);
5.select ename,sal from TbEmp where sal >(select avg(sal) from TbEmp);
1.select ename, sal, t1.dno from TbEmp as t1,
 (select dno, max(sal) as maxSal from TbEmp group by dno) as t2 where     t1.dno=t2.dno and t1.sal = t2.maxSal;
```

##FMDB的核心API
	
	FMDatabase --- 代表数据库
	FMResultSet --- 代表操作查询结果的游标
	FMDatabaseAdditions --- 对FMDatabase类扩展的Category
	FMDatabasePool --- 数据库连接池支持类
	FMDatabaseQueue --- 数据库多线程操作支持类
	
​```Objective-C
// 创建数据库
- (void) createDb {
    NSString *path = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/test.db"];
    NSLog(@"%@", path);
    self.db = [[FMDatabase alloc] initWithPath:path];
    if([self.db open]) {
        [self createTable];
    }
    else {
        NSLog(@"创建数据库失败!");
    }
}

// 创建表
- (void) createTable {
    NSString *sql = @"create table if not exists tb_user (username varchar(20) primary key, password varchar(20) not null, email varchar(50));";
    if([self.db executeUpdate:sql]) {
        [self insertData];
    }
    else {
        NSLog(@"创建用户表失败!");
    }
}

// 插入数据
- (void) insertData {
    NSString *sql = @"insert into tb_user values (?,?,?);";
    if([self.db executeUpdate:sql, @"jackfrued", @"123456", @"jackfrued@126.com"]) {
        
    }
    else {
        NSLog(@"插入数据失败!");
    }
}

// 显示表中的记录
- (void) showRecords {
    NSString *path = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/test.db"];
    self.db = [[FMDatabase alloc] initWithPath:path];
    if([self.db open]) {
        NSString *sql = @"select * from tb_user";
        FMResultSet *rs = [self.db executeQuery:sql];
        NSLog(@"%d", rs.next);
        while([rs next]) {
            NSLog(@"Username: %@", [rs stringForColumn:@"username"]);
            NSLog(@"Password: %@", [rs stringForColumn:@"password"]);
            NSLog(@"Email: %@", [rs stringForColumn:@"email"]);
        }
        
        [self clearData];
    }
    else {
        NSLog(@"创建数据库失败!");
    }
}

- (void) clearData {
    NSString *sql = @"delete from tb_user";
    if([self.db executeUpdate:sql]) {
        NSLog(@"清理数据成功!!!");
    }
}```

```
@interface ViewController () <UITableViewDataSource, UITableViewDelegate> {
    UITableView *myTableView;
    NSMutableArray *dataArray;
    FMDatabase *db;
}

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];

    self.title = @"部门信息";

    myTableView = [[UITableView alloc] initWithFrame:self.view.bounds style:UITableViewStylePlain];
    [self.view addSubview:myTableView];

    myTableView.dataSource = self;
    myTableView.delegate = self;

    [self loadDataModel];

    self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAdd target:self action:@selector(addDept:)];
    self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"编辑" style:UIBarButtonItemStylePlain target:self action:@selector(editDept:)];

    [self registerObserver];
    }

- (void) editDept:(UIBarButtonItem *) sender {
    if ([myTableView isEditing]) {
        [myTableView setEditing:NO animated:YES];
        [sender setTitle:@"编辑"];
    }
    else {
        [myTableView setEditing:YES animated:YES];
        [sender setTitle:@"完成"];
    }
    }

- (void) registerObserver {
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(notificationReceived:) name:@"AddDeptNotification" object:nil];
    }

- (void) notificationReceived:(NSNotification *) sender {
    [dataArray addObject:sender.object];
    [myTableView insertRowsAtIndexPaths:@[[NSIndexPath indexPathForRow:dataArray.count - 1 inSection:0]] withRowAnimation:UITableViewRowAnimationRight];
    }

- (void) addDept:(id) sender {
    CDDeptViewController *deptVC = [[CDDeptViewController alloc] init];
    [self.navigationController pushViewController:deptVC animated:YES];
    }

- (void) loadDataModel {
    if (!dataArray) {
        dataArray = [NSMutableArray array];
    }

    // 从嵌入式数据库sqlite3中加载数据
    NSString *filePath = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/company.db"];
    // 创建数据库对象
    db = [FMDatabase databaseWithPath:filePath];
    if (db && [db open]) {
        NSString *sql = @"select deptno, dname, dloc, total from TbDept as t1 left outer join (select dno, count(dno) as total from TbEmp group by dno) as t2 on t1.deptno=t2.dno";
        // 执行查询的SQL语句获得结果集(游标)
        FMResultSet *rs = [db executeQuery:sql];
        while ([rs next]) {
            // 对查询结果的行进行迭代从行中取出数据
            // 每一行就是一个部门的记录
            CDDept *model = [[CDDept alloc] init];
            
            // 通过结果集对象的方法取出指定的列的数据
            model.no = [rs intForColumn:@"deptno"];
            model.name = [rs stringForColumn:@"dname"];
            model.location = [rs stringForColumn:@"dloc"];
            model.total = [rs intForColumn:@"total"];
            
            // 将模型添加到数组中
            [dataArray addObject:model];
        }
        // 刷新表格视图
        [myTableView reloadData];
    }
    else {
        NSLog(@"创建或打开数据库失败!!!");
    }
    }

- (NSInteger) tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return dataArray.count;
    }

- (UITableViewCell *) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"CELL"];

    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"CELL"];
    }

    CDDept *model = dataArray[indexPath.row];

    cell.accessoryType = model.total > 0? UITableViewCellAccessoryDisclosureIndicator: UITableViewCellAccessoryNone;

    cell.textLabel.text = [NSString stringWithFormat:@"%@(%ld)", model.name, model.total];

    return cell;
    }

- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        CDDept *model = dataArray[indexPath.row];
        if (model.total == 0) {
            if (db && [db open]) {
                // executeUpdate --- 增删改
                // executeQuery --- 查询
                if ([db executeUpdate:@"delete from TbDept where deptno=?", @(model.no)]) {
                    [dataArray removeObject:model];
                    // [dataArray removeObjectAtIndex:indexPath.row];
                    [myTableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationLeft];
                }
                else {
                    NSLog(@"删除部门失败!!!");
                }
            }
            else {
                NSLog(@"创建或打开数据库失败!!!");
            }
        }
    }
    }

- (void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    CDDept *model = dataArray[indexPath.row];
    // if (model.total > 0) {
        // 如果部门人数大于0就导航到查看员工名单的视图控制器
        CDEmpViewController *empVC = [[CDEmpViewController alloc] init];
        empVC.model = model;
        [self.navigationController pushViewController:empVC animated:YES];
    // }
    }

- (void)dealloc {
    [[NSNotificationCenter defaultCenter] removeObserver:self];
    }

- (IBAction)okButtonClicked:(id)sender {
    NSString *name = [_nameLabel.text trim];
    NSString *location = [_locationLabel.text trim];
    // 从嵌入式数据库sqlite3中加载数据
    NSString *filePath = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/company.db"];
    // 创建数据库对象
    FMDatabase *db = [FMDatabase databaseWithPath:filePath];
    if (db && [db open]) {
        FMResultSet *rs = [db executeQuery:@"select max(deptno) as maxDno from TbDept"];
        if ([rs next]) {
            int no = [rs intForColumn:@"maxDno"];
            no += 10;
            NSString *sql = @"insert into TbDept values (?,?,?)";
            if ([db executeUpdate:sql, @(no), name, location]) {
                CDDept *model = [[CDDept alloc] init];
                model.no = no;
                model.name = name;
                model.location = location;
                NSNotification *note = [[NSNotification alloc] initWithName:@"AddDeptNotification" object:model userInfo:nil];
                [[NSNotificationCenter defaultCenter] postNotification:note];
                [self.navigationController popViewControllerAnimated:YES];
            }
            else {
                NSLog(@"添加新部门失败!!!");
            }
        }
    }
    else {
        NSLog(@"创建或打开数据库失败!!!");
    }
    }```